{{ if eq hugo.Environment "development" }}
  {{ $missing := slice }}

  {{ range .Site.RegularPages }}
    {{ $url := .Permalink }}
    {{ $exists := false }}

    <!-- PrÃ¼fen, ob URL bereits in sitemap.yaml enthalten ist -->
    {{ range .Site.Data.settings.sitemap.sitemap }}
      {{ if eq .url $url }}
        {{ $exists = true }}
      {{ end }}
    {{ end }}

    <!-- Falls nicht vorhanden, zur Liste hinzufÃ¼gen -->
    {{ if not $exists }}
      {{ $entry := dict "url" .Permalink "changefreq" "weekly" "priority" "0.5" }}
      {{ $missing = $missing | append $entry }}
    {{ end }}
  {{ end }}

  <!-- JSON-Datei tatsÃ¤chlich speichern -->
  {{ $outputPath := "data/sitemap-missing.json" }}
  {{ os.WriteFile $outputPath (transform.Marshal (dict "sitemap_missing" $missing) "json") }}

  <p>âœ… <strong>Sitemap-VorschlÃ¤ge wurden generiert und gespeichert.</strong></p>
  <p><a href="/data/sitemap-missing.json" download>ðŸ“¥ Fehlende Sitemap-URLs als JSON herunterladen</a></p>
{{ end }}
